## 쿼리 실행 구조

MySQL 구조에서 MySQL 서버에서 제공하는 기능 중 `쿼리 파서`, `전 처리기`, `쿼리 옵티마이저`, `실행엔진`, `헨들러`가 있다.

- `쿼리파서`: 사용자로 부터 받은 쿼리를 문법적으로 트리구조로 나눈다. 문법오류는 이때 발견된다.

- `전 처리기`: 전 처리기는 앞서서 만들어진 트리의 구조적인 문제를 파악한다. 문장 내에 명시된 테이블이나 컬럼명이 실제로 존재하는지 검사하고, 접근권한 검사등이 수행된다.

- `옵티마이저`: 쿼리 실행에 있어서 더 나은 선택을 하도록 도와주는 장치

- `실행엔진`: 실행엔진은 쿼리 실행계획에 따라 스토리지엔진과의 소통인 헨들러를 통해 중간 관리자 역할을 수행한다.

## 트랜잭션을 지원하는 메타데이터

데이터베이스에서 테이블의 구조정보와 스토어드 프로그램등의 정보를 `데이터 딕셔너리` 혹은 `메타데이터`라고 표현한다.

이같은 `메타데이터`는 MySQL 5.7버전까지는 별도의 `파일`로 보관하였고, 파일기반은 트랜잭션을 지원하지 않기 때문에, 테이블 관련 생성 혹은 변경 작업도중에 비정상적으로 서버가 종료됨으로 인해 메타데이터가 깨지는경우가 자주있었다.

그래서 MySQL8.0부터는 MySQL이 구동되는데 필요한 필수 테이블 + `메타데이터` 모두 모아서 InnoDB 엔진아래에 `mysql` DB에 저장된다.

이로인해 자연스럽게 트랜잭션을 지원하게 되어 비정상적으로 종료되더라도 작업이 전부 완료됨 혹은 전부 실패됨으로 정리되었다.

